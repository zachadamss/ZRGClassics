---
layout: layouts/base.njk
title: Maintenance Tracker
description: "Track service history and maintenance schedules for your vintage BMW and Porsche. Vehicle-specific presets, mileage and date-based reminders, export to JSON and CSV."
keywords: "maintenance tracker, service history, car maintenance log, BMW maintenance, Porsche maintenance, vehicle service tracker"
---

<div class="maintenance-tracker">
    <div class="tracker-header">
        <h1>Maintenance Tracker</h1>
        <p>Track service history and maintenance schedules for your vintage German cars</p>
    </div>

    <!-- Logged-in user notice -->
    <div class="garage-notice" id="garage-notice" style="display: none;">
        <div class="notice-content">
            <strong>Sync your data across devices!</strong>
            <p>As a registered member, your vehicle maintenance is saved to your account in <a href="/account/garage/">My Garage</a>. This page uses local browser storage only.</p>
        </div>
        <a href="/account/garage/" class="btn btn-primary">Go to My Garage</a>
    </div>

    <!-- Garage View -->
    <div class="tracker-section garage-section">
        <div class="section-header">
            <h2>My Garage</h2>
            <button type="button" class="btn btn-primary" id="add-vehicle-btn">+ Add Vehicle</button>
        </div>
        <div class="garage-grid" id="garage-grid">
            <!-- Vehicle cards will be inserted here -->
            <div class="empty-garage" id="empty-garage">
                <p>No vehicles in your garage yet.</p>
                <p>Click "Add Vehicle" to get started.</p>
            </div>
        </div>
    </div>

    <!-- Add/Edit Vehicle Modal -->
    <div class="modal-overlay" id="vehicle-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="vehicle-modal-title">Add Vehicle</h3>
                <button type="button" class="modal-close" id="close-vehicle-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="vehicle-name">Vehicle Name</label>
                    <input type="text" id="vehicle-name" placeholder="e.g., My E30 M3, Daily 996">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="vehicle-platform">Platform</label>
                        <select id="vehicle-platform">
                            <option value="">Select a platform...</option>
                            <optgroup label="BMW">
                                <option value="e28">E28 5-Series (1982-1988)</option>
                                <option value="e30">E30 3-Series (1982-1994)</option>
                                <option value="e34">E34 5-Series (1988-1996)</option>
                                <option value="e36">E36 3-Series (1990-2000)</option>
                                <option value="e39">E39 5-Series (1995-2004)</option>
                                <option value="e46">E46 3-Series (1998-2006)</option>
                                <option value="e90">E90 3-Series (2005-2013)</option>
                            </optgroup>
                            <optgroup label="Porsche">
                                <option value="924">924 (1976-1988)</option>
                                <option value="928">928 (1977-1995)</option>
                                <option value="944">944 (1982-1991)</option>
                                <option value="964">964 911 (1989-1994)</option>
                                <option value="986">986 Boxster (1996-2004)</option>
                                <option value="987">987 Boxster/Cayman (2005-2012)</option>
                                <option value="991">991 911 (2011-2019)</option>
                                <option value="993">993 911 (1994-1998)</option>
                                <option value="996">996 911 (1997-2005)</option>
                                <option value="997">997 911 (2004-2012)</option>
                            </optgroup>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="vehicle-year">Year</label>
                        <input type="number" id="vehicle-year" min="1976" max="2025" placeholder="e.g., 1995">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="vehicle-mileage">Current Mileage</label>
                        <input type="number" id="vehicle-mileage" min="0" placeholder="e.g., 125000">
                    </div>
                    <div class="form-group">
                        <label for="vehicle-purchase-date">Purchase Date</label>
                        <input type="date" id="vehicle-purchase-date">
                    </div>
                </div>
                <div class="form-group">
                    <label for="vehicle-vin">VIN (optional)</label>
                    <input type="text" id="vehicle-vin" placeholder="e.g., WBAAB5401J8123456">
                </div>
                <input type="hidden" id="vehicle-edit-id">
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="cancel-vehicle">Cancel</button>
                <button type="button" class="btn btn-primary" id="save-vehicle">Save Vehicle</button>
            </div>
        </div>
    </div>

    <!-- Vehicle Detail View -->
    <div class="tracker-section vehicle-detail-section" id="vehicle-detail" style="display: none;">
        <div class="section-header">
            <button type="button" class="btn btn-secondary" id="back-to-garage">&larr; Back to Garage</button>
            <div class="vehicle-info">
                <h2 id="detail-vehicle-name">Vehicle Name</h2>
                <span class="vehicle-platform-badge" id="detail-vehicle-platform">E30</span>
            </div>
            <div class="vehicle-actions">
                <button type="button" class="btn btn-secondary" id="edit-vehicle-btn">Edit</button>
                <button type="button" class="btn btn-danger" id="delete-vehicle-btn">Delete</button>
            </div>
        </div>

        <!-- Mileage Update -->
        <div class="mileage-card">
            <div class="mileage-display">
                <span class="mileage-label">Current Mileage</span>
                <span class="mileage-value" id="current-mileage-display">0</span>
                <span class="mileage-unit">miles</span>
            </div>
            <div class="mileage-update">
                <input type="number" id="update-mileage" placeholder="Enter new mileage">
                <button type="button" class="btn btn-primary" id="update-mileage-btn">Update</button>
            </div>
        </div>

        <!-- Tabs -->
        <div class="detail-tabs">
            <button type="button" class="tab-btn active" data-tab="upcoming">Upcoming Maintenance</button>
            <button type="button" class="tab-btn" data-tab="schedule">Maintenance Schedule</button>
            <button type="button" class="tab-btn" data-tab="history">Service History</button>
        </div>

        <!-- Upcoming Maintenance Tab -->
        <div class="tab-content active" id="tab-upcoming">
            <div class="upcoming-header">
                <h3>Upcoming & Overdue</h3>
            </div>
            <div class="upcoming-list" id="upcoming-list">
                <!-- Upcoming items will be inserted here -->
            </div>
        </div>

        <!-- Maintenance Schedule Tab -->
        <div class="tab-content" id="tab-schedule">
            <div class="schedule-header">
                <h3>Maintenance Schedule</h3>
                <button type="button" class="btn btn-secondary" id="add-maintenance-item">+ Add Item</button>
            </div>
            <div class="schedule-table-wrapper">
                <table class="schedule-table">
                    <thead>
                        <tr>
                            <th>Item</th>
                            <th>Interval (Miles)</th>
                            <th>Interval (Months)</th>
                            <th>Last Service</th>
                            <th>Next Due</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="schedule-tbody">
                        <!-- Schedule rows will be inserted here -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Service History Tab -->
        <div class="tab-content" id="tab-history">
            <div class="history-header">
                <h3>Service History</h3>
                <button type="button" class="btn btn-secondary" id="add-service-record">+ Add Record</button>
            </div>
            <div class="history-list" id="history-list">
                <!-- History items will be inserted here -->
            </div>
        </div>
    </div>

    <!-- Add/Edit Maintenance Item Modal -->
    <div class="modal-overlay" id="maintenance-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="maintenance-modal-title">Add Maintenance Item</h3>
                <button type="button" class="modal-close" id="close-maintenance-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="maintenance-name">Item Name</label>
                    <input type="text" id="maintenance-name" placeholder="e.g., Oil Change, Timing Belt">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="maintenance-interval-miles">Interval (Miles)</label>
                        <input type="number" id="maintenance-interval-miles" min="0" placeholder="e.g., 5000">
                    </div>
                    <div class="form-group">
                        <label for="maintenance-interval-months">Interval (Months)</label>
                        <input type="number" id="maintenance-interval-months" min="0" placeholder="e.g., 12">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="maintenance-last-mileage">Last Service Mileage</label>
                        <input type="number" id="maintenance-last-mileage" min="0" placeholder="e.g., 120000">
                    </div>
                    <div class="form-group">
                        <label for="maintenance-last-date">Last Service Date</label>
                        <input type="date" id="maintenance-last-date">
                    </div>
                </div>
                <input type="hidden" id="maintenance-edit-id">
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="cancel-maintenance">Cancel</button>
                <button type="button" class="btn btn-primary" id="save-maintenance">Save Item</button>
            </div>
        </div>
    </div>

    <!-- Add Service Record Modal -->
    <div class="modal-overlay" id="service-modal">
        <div class="modal-content modal-wide">
            <div class="modal-header">
                <h3 id="service-modal-title">Log Service</h3>
                <button type="button" class="modal-close" id="close-service-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-row">
                    <div class="form-group">
                        <label for="service-item">Service Performed</label>
                        <select id="service-item">
                            <option value="">Select or enter custom...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="service-item-custom">Custom Service Name</label>
                        <input type="text" id="service-item-custom" placeholder="e.g., Replaced water pump">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="service-date">Service Date</label>
                        <input type="date" id="service-date">
                    </div>
                    <div class="form-group">
                        <label for="service-mileage">Mileage at Service</label>
                        <input type="number" id="service-mileage" min="0" placeholder="e.g., 125000">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="service-cost">Cost ($)</label>
                        <input type="number" id="service-cost" min="0" step="0.01" placeholder="e.g., 150.00">
                    </div>
                    <div class="form-group">
                        <label for="service-shop">Shop / DIY</label>
                        <select id="service-shop">
                            <option value="diy">DIY</option>
                            <option value="shop">Professional Shop</option>
                            <option value="dealer">Dealer</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="service-parts">Parts Used</label>
                    <input type="text" id="service-parts" placeholder="e.g., Mahle filter, Liqui Moly 0W-40">
                </div>
                <div class="form-group">
                    <label for="service-notes">Notes</label>
                    <textarea id="service-notes" rows="3" placeholder="Any additional notes about this service..."></textarea>
                </div>
                <input type="hidden" id="service-edit-id">
                <input type="hidden" id="service-linked-maintenance-id">
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="cancel-service">Cancel</button>
                <button type="button" class="btn btn-primary" id="save-service">Save Record</button>
            </div>
        </div>
    </div>

    <!-- Export Actions -->
    <div class="tracker-section export-section">
        <h3>Data Management</h3>
        <div class="export-buttons">
            <button type="button" class="btn btn-secondary" id="export-json">Export Backup (JSON)</button>
            <button type="button" class="btn btn-secondary" id="export-csv">Export to CSV</button>
            <button type="button" class="btn btn-secondary" id="import-json">Import Backup</button>
            <button type="button" class="btn btn-secondary" id="print-records">Print Records</button>
        </div>
        <input type="file" id="import-file" accept=".json" style="display: none;">
    </div>
</div>

<script src="/tools/maintenance-tracker.js"></script>
<script>
// Show garage notice for logged-in users
document.addEventListener('DOMContentLoaded', async () => {
    if (typeof Auth !== 'undefined') {
        const user = await Auth.getUser();
        if (user) {
            document.getElementById('garage-notice').style.display = 'flex';
        }
    }
});
</script>
